import * as dotenv from "dotenv";
import { Kafka, logLevel } from "kafkajs";

dotenv.config();

export const coordinates = {
  1: [
    { lat: -15.82594, long: -47.92923, last: false },
    { lat: -15.8261, long: -47.92911, last: false },
    { lat: -15.82615, long: -47.92907, last: false },
    { lat: -15.82637, long: -47.92889, last: false },
    { lat: -15.82651, long: -47.92878, last: false },
    { lat: -15.82655, long: -47.92875, last: false },
    { lat: -15.82665, long: -47.92867, last: false },
    { lat: -15.82636, long: -47.92827, last: false },
    { lat: -15.82615, long: -47.92798, last: false },
    { lat: -15.82651, long: -47.9277, last: false },
    { lat: -15.82658, long: -47.92765, last: false },
    { lat: -15.82701, long: -47.92732, last: false },
    { lat: -15.82733, long: -47.92706, last: false },
    { lat: -15.82749, long: -47.92694, last: false },
    { lat: -15.8272, long: -47.92653, last: false },
    { lat: -15.82717, long: -47.9265, last: false },
    { lat: -15.82686, long: -47.92607, last: false },
    { lat: -15.82683, long: -47.92603, last: false },
    { lat: -15.82678, long: -47.92596, last: false },
    { lat: -15.82676, long: -47.92594, last: false },
    { lat: -15.82671, long: -47.92586, last: false },
    { lat: -15.82666, long: -47.92578, last: false },
    { lat: -15.82659, long: -47.92569, last: false },
    { lat: -15.82644, long: -47.92548, last: false },
    { lat: -15.8262, long: -47.92515, last: false },
    { lat: -15.82614, long: -47.92506, last: false },
    { lat: -15.82596, long: -47.92482, last: false },
    { lat: -15.8259, long: -47.92474, last: false },
    { lat: -15.82587, long: -47.9247, last: false },
    { lat: -15.82579, long: -47.92457, last: false },
    { lat: -15.82568, long: -47.92442, last: false },
    { lat: -15.8261, long: -47.92412, last: false },
    { lat: -15.82642, long: -47.92387, last: false },
    { lat: -15.82643, long: -47.92386, last: false },
    { lat: -15.82644, long: -47.92385, last: false },
    { lat: -15.82645, long: -47.92384, last: false },
    { lat: -15.82647, long: -47.92382, last: false },
    { lat: -15.82648, long: -47.9238, last: false },
    { lat: -15.82648, long: -47.92378, last: false },
    { lat: -15.82649, long: -47.92376, last: false },
    { lat: -15.82649, long: -47.92375, last: false },
    { lat: -15.8265, long: -47.92373, last: false },
    { lat: -15.8265, long: -47.92372, last: false },
    { lat: -15.8265, long: -47.9237, last: false },
    { lat: -15.8265, long: -47.92369, last: false },
    { lat: -15.82649, long: -47.92363, last: false },
    { lat: -15.8265, long: -47.92352, last: false },
    { lat: -15.8265, long: -47.92351, last: false },
    { lat: -15.8265, long: -47.92349, last: false },
    { lat: -15.82651, long: -47.92348, last: false },
    { lat: -15.82651, long: -47.92346, last: false },
    { lat: -15.82652, long: -47.92345, last: false },
    { lat: -15.82652, long: -47.92344, last: false },
    { lat: -15.82653, long: -47.92342, last: false },
    { lat: -15.82653, long: -47.92341, last: false },
    { lat: -15.82654, long: -47.9234, last: false },
    { lat: -15.82655, long: -47.92339, last: false },
    { lat: -15.82656, long: -47.92338, last: false },
    { lat: -15.82663, long: -47.92334, last: false },
    { lat: -15.8267, long: -47.92329, last: false },
    { lat: -15.82685, long: -47.92317, last: false },
    { lat: -15.827, long: -47.92305, last: false },
    { lat: -15.82711, long: -47.92298, last: false },
    { lat: -15.82721, long: -47.92291, last: false },
    { lat: -15.82731, long: -47.92283, last: false },
    { lat: -15.82741, long: -47.92274, last: false },
    { lat: -15.8275, long: -47.92267, last: false },
    { lat: -15.82758, long: -47.9226, last: false },
    { lat: -15.82761, long: -47.92257, last: false },
    { lat: -15.82764, long: -47.92255, last: false },
    { lat: -15.82775, long: -47.92246, last: false },
    { lat: -15.82787, long: -47.92238, last: false },
    { lat: -15.8281, long: -47.92222, last: false },
    { lat: -15.8281, long: -47.92223, last: false },
    { lat: -15.82811, long: -47.92223, last: false },
    { lat: -15.82812, long: -47.92224, last: false },
    { lat: -15.82812, long: -47.92225, last: false },
    { lat: -15.82813, long: -47.92225, last: false },
    { lat: -15.82814, long: -47.92226, last: false },
    { lat: -15.82815, long: -47.92226, last: false },
    { lat: -15.82816, long: -47.92227, last: false },
    { lat: -15.82817, long: -47.92227, last: false },
    { lat: -15.82818, long: -47.92228, last: false },
    { lat: -15.82819, long: -47.92228, last: false },
    { lat: -15.8282, long: -47.92228, last: false },
    { lat: -15.82821, long: -47.92228, last: false },
    { lat: -15.82822, long: -47.92228, last: false },
    { lat: -15.82823, long: -47.92228, last: false },
    { lat: -15.82824, long: -47.92227, last: false },
    { lat: -15.82825, long: -47.92227, last: false },
    { lat: -15.82826, long: -47.92227, last: false },
    { lat: -15.82826, long: -47.92226, last: false },
    { lat: -15.82827, long: -47.92226, last: false },
    { lat: -15.82828, long: -47.92225, last: false },
    { lat: -15.82847, long: -47.92251, last: false },
    { lat: -15.82853, long: -47.9226, last: false },
    { lat: -15.82923, long: -47.92354, last: false },
    { lat: -15.82935, long: -47.92373, last: false },
    { lat: -15.82947, long: -47.92391, last: false },
    { lat: -15.82947, long: -47.92392, last: false },
    { lat: -15.82946, long: -47.92393, last: false },
    { lat: -15.82946, long: -47.92394, last: false },
    { lat: -15.82946, long: -47.92395, last: false },
    { lat: -15.82945, long: -47.92396, last: false },
    { lat: -15.82945, long: -47.92397, last: false },
    { lat: -15.82945, long: -47.92398, last: false },
    { lat: -15.82946, long: -47.92399, last: false },
    { lat: -15.82946, long: -47.924, last: false },
    { lat: -15.82946, long: -47.92401, last: false },
    { lat: -15.82946, long: -47.92402, last: false },
    { lat: -15.82947, long: -47.92402, last: false },
    { lat: -15.82947, long: -47.92403, last: false },
    { lat: -15.82948, long: -47.92404, last: false },
    { lat: -15.82949, long: -47.92405, last: false },
    { lat: -15.8295, long: -47.92405, last: false },
    { lat: -15.8295, long: -47.92406, last: false },
    { lat: -15.82951, long: -47.92406, last: false },
    { lat: -15.82952, long: -47.92407, last: false },
    { lat: -15.82953, long: -47.92407, last: false },
    { lat: -15.82954, long: -47.92407, last: false },
    { lat: -15.82955, long: -47.92407, last: false },
    { lat: -15.82956, long: -47.92407, last: false },
    { lat: -15.82964, long: -47.92423, last: false },
    { lat: -15.82974, long: -47.92444, last: false },
    { lat: -15.82979, long: -47.9245, last: false },
    { lat: -15.82998, long: -47.92475, last: false },
    { lat: -15.82997, long: -47.92477, last: false },
    { lat: -15.82997, long: -47.92478, last: false },
    { lat: -15.82996, long: -47.92479, last: false },
    { lat: -15.82996, long: -47.9248, last: false },
    { lat: -15.82996, long: -47.92482, last: false },
    { lat: -15.82996, long: -47.92483, last: false },
    { lat: -15.82996, long: -47.92484, last: false },
    { lat: -15.82996, long: -47.92486, last: false },
    { lat: -15.82996, long: -47.92487, last: false },
    { lat: -15.82997, long: -47.92488, last: false },
    { lat: -15.82997, long: -47.92489, last: false },
    { lat: -15.82998, long: -47.9249, last: false },
    { lat: -15.82999, long: -47.92492, last: false },
    { lat: -15.82999, long: -47.92493, last: false },
    { lat: -15.83, long: -47.92494, last: false },
    { lat: -15.83001, long: -47.92495, last: false },
    { lat: -15.83002, long: -47.92496, last: false },
    { lat: -15.83003, long: -47.92497, last: false },
    { lat: -15.83004, long: -47.92497, last: false },
    { lat: -15.83005, long: -47.92498, last: false },
    { lat: -15.83006, long: -47.92499, last: false },
    { lat: -15.83008, long: -47.92499, last: false },
    { lat: -15.83009, long: -47.92499, last: false },
    { lat: -15.8301, long: -47.925, last: false },
    { lat: -15.83011, long: -47.925, last: false },
    { lat: -15.83013, long: -47.925, last: false },
    { lat: -15.83015, long: -47.925, last: false },
    { lat: -15.83022, long: -47.92511, last: false },
    { lat: -15.83034, long: -47.92529, last: false },
    { lat: -15.83041, long: -47.92536, last: false },
    { lat: -15.83047, long: -47.92543, last: false },
    { lat: -15.83063, long: -47.92564, last: false },
    { lat: -15.83063, long: -47.92565, last: false },
    { lat: -15.83062, long: -47.92565, last: false },
    { lat: -15.83062, long: -47.92566, last: false },
    { lat: -15.83061, long: -47.92566, last: false },
    { lat: -15.83061, long: -47.92567, last: false },
    { lat: -15.83061, long: -47.92568, last: false },
    { lat: -15.8306, long: -47.92568, last: false },
    { lat: -15.8306, long: -47.92569, last: false },
    { lat: -15.8306, long: -47.9257, last: false },
    { lat: -15.8306, long: -47.92571, last: false },
    { lat: -15.8306, long: -47.92572, last: false },
    { lat: -15.8306, long: -47.92573, last: false },
    { lat: -15.83061, long: -47.92573, last: false },
    { lat: -15.83061, long: -47.92574, last: false },
    { lat: -15.83061, long: -47.92575, last: false },
    { lat: -15.83062, long: -47.92575, last: false },
    { lat: -15.83062, long: -47.92576, last: false },
    { lat: -15.83063, long: -47.92576, last: false },
    { lat: -15.83063, long: -47.92577, last: false },
    { lat: -15.83064, long: -47.92577, last: false },
    { lat: -15.83068, long: -47.92593, last: false },
    { lat: -15.83068, long: -47.92596, last: false },
    { lat: -15.83068, long: -47.92599, last: false },
    { lat: -15.83065, long: -47.92606, last: false },
    { lat: -15.83044, long: -47.92624, last: false },
    { lat: -15.83041, long: -47.92626, last: false },
    { lat: -15.83038, long: -47.92628, last: false },
    { lat: -15.83035, long: -47.92631, last: false },
    { lat: -15.83033, long: -47.92634, last: false },
    { lat: -15.8303, long: -47.92636, last: false },
    { lat: -15.83029, long: -47.92637, last: false },
    { lat: -15.83028, long: -47.9264, last: false },
    { lat: -15.83027, long: -47.92642, last: false },
    { lat: -15.83025, long: -47.92644, last: false },
    { lat: -15.83024, long: -47.92646, last: false },
    { lat: -15.83024, long: -47.92648, last: false },
    { lat: -15.83023, long: -47.9265, last: false },
    { lat: -15.83022, long: -47.92651, last: false },
    { lat: -15.8302, long: -47.92656, last: false },
    { lat: -15.83018, long: -47.92661, last: false },
    { lat: -15.83015, long: -47.92665, last: false },
    { lat: -15.83012, long: -47.9267, last: false },
    { lat: -15.8301, long: -47.92674, last: false },
    { lat: -15.83006, long: -47.9268, last: false },
    { lat: -15.83003, long: -47.92684, last: false },
    { lat: -15.83001, long: -47.92686, last: false },
    { lat: -15.83, long: -47.92688, last: false },
    { lat: -15.82998, long: -47.9269, last: false },
    { lat: -15.82995, long: -47.92692, last: false },
    { lat: -15.82993, long: -47.92694, last: false },
    { lat: -15.82991, long: -47.92696, last: false },
    { lat: -15.82988, long: -47.92698, last: false },
    { lat: -15.82985, long: -47.92701, last: false },
    { lat: -15.82983, long: -47.92703, last: false },
    { lat: -15.8298, long: -47.92705, last: false },
    { lat: -15.82979, long: -47.92706, last: false },
    { lat: -15.82966, long: -47.92716, last: false },
    { lat: -15.82972, long: -47.92723, last: false },
    { lat: -15.8298, long: -47.92735, last: false },
    { lat: -15.82966, long: -47.92746, last: false },
    { lat: -15.82942, long: -47.92765, last: true },
  ],
  2: [
    { lat: -15.82449, long: -47.92756, last: false },
    { lat: -15.82404, long: -47.9269, last: false },
    { lat: -15.82397, long: -47.9268, last: false },
    { lat: -15.82386, long: -47.92661, last: false },
    { lat: -15.82418, long: -47.92636, last: false },
    { lat: -15.8243, long: -47.92627, last: false },
    { lat: -15.82436, long: -47.92623, last: false },
    { lat: -15.82441, long: -47.92619, last: false },
    { lat: -15.82452, long: -47.92611, last: false },
    { lat: -15.82465, long: -47.92601, last: false },
    { lat: -15.82478, long: -47.9259, last: false },
    { lat: -15.825, long: -47.9257, last: false },
    { lat: -15.82501, long: -47.92573, last: false },
    { lat: -15.82527, long: -47.92552, last: false },
    { lat: -15.82537, long: -47.92546, last: false },
    { lat: -15.82546, long: -47.92538, last: false },
    { lat: -15.82554, long: -47.92532, last: false },
    { lat: -15.82568, long: -47.92522, last: false },
    { lat: -15.8257, long: -47.9252, last: false },
    { lat: -15.82588, long: -47.92501, last: false },
    { lat: -15.82601, long: -47.9252, last: false },
    { lat: -15.82636, long: -47.92569, last: false },
    { lat: -15.82648, long: -47.92584, last: false },
    { lat: -15.82651, long: -47.92589, last: false },
    { lat: -15.82656, long: -47.92596, last: false },
    { lat: -15.8267, long: -47.92615, last: false },
    { lat: -15.82733, long: -47.92706, last: false },
    { lat: -15.82759, long: -47.9274, last: false },
    { lat: -15.82807, long: -47.92805, last: false },
    { lat: -15.82836, long: -47.92845, last: false },
    { lat: -15.82843, long: -47.92839, last: false },
    { lat: -15.82851, long: -47.92833, last: false },
    { lat: -15.82825, long: -47.92797, last: false },
    { lat: -15.82796, long: -47.92759, last: false },
    { lat: -15.82773, long: -47.92727, last: false },
    { lat: -15.82795, long: -47.92712, last: false },
    { lat: -15.82804, long: -47.92703, last: false },
    { lat: -15.82814, long: -47.92695, last: false },
    { lat: -15.82812, long: -47.92692, last: false },
    { lat: -15.8276, long: -47.92621, last: true },
  ],
  3: [
    { lat: -15.82331, long: -47.92588, last: false },
    { lat: -15.82327, long: -47.92584, last: false },
    { lat: -15.82306, long: -47.92553, last: false },
    { lat: -15.82284, long: -47.92522, last: false },
    { lat: -15.82281, long: -47.92519, last: false },
    { lat: -15.82277, long: -47.92513, last: false },
    { lat: -15.82271, long: -47.92504, last: false },
    { lat: -15.82262, long: -47.92492, last: false },
    { lat: -15.8225, long: -47.92476, last: false },
    { lat: -15.82235, long: -47.92454, last: false },
    { lat: -15.8219, long: -47.92394, last: false },
    { lat: -15.82185, long: -47.92387, last: false },
    { lat: -15.82174, long: -47.92372, last: false },
    { lat: -15.82164, long: -47.92357, last: false },
    { lat: -15.82152, long: -47.92342, last: false },
    { lat: -15.82105, long: -47.92377, last: false },
    { lat: -15.8211, long: -47.92384, last: false },
    { lat: -15.82119, long: -47.92395, last: false },
    { lat: -15.82127, long: -47.92406, last: false },
    { lat: -15.82133, long: -47.92413, last: false },
    { lat: -15.82136, long: -47.92419, last: false },
    { lat: -15.82159, long: -47.92451, last: false },
    { lat: -15.82186, long: -47.92488, last: false },
    { lat: -15.82188, long: -47.92491, last: false },
    { lat: -15.82196, long: -47.92502, last: false },
    { lat: -15.82208, long: -47.92519, last: false },
    { lat: -15.82218, long: -47.92533, last: false },
    { lat: -15.82229, long: -47.92548, last: false },
    { lat: -15.82234, long: -47.92555, last: false },
    { lat: -15.82237, long: -47.9256, last: false },
    { lat: -15.82241, long: -47.92564, last: false },
    { lat: -15.82261, long: -47.92592, last: false },
    { lat: -15.82276, long: -47.92612, last: false },
    { lat: -15.82278, long: -47.92615, last: false },
    { lat: -15.82303, long: -47.9265, last: false },
    { lat: -15.82311, long: -47.92663, last: false },
    { lat: -15.82314, long: -47.92668, last: false },
    { lat: -15.8232, long: -47.92687, last: false },
    { lat: -15.8232, long: -47.92688, last: false },
    { lat: -15.8232, long: -47.92689, last: false },
    { lat: -15.8232, long: -47.9269, last: false },
    { lat: -15.8232, long: -47.92691, last: false },
    { lat: -15.8232, long: -47.92692, last: false },
    { lat: -15.8232, long: -47.92693, last: false },
    { lat: -15.8232, long: -47.92694, last: false },
    { lat: -15.8232, long: -47.92695, last: false },
    { lat: -15.82321, long: -47.92696, last: false },
    { lat: -15.82321, long: -47.92697, last: false },
    { lat: -15.82322, long: -47.92698, last: false },
    { lat: -15.82322, long: -47.92699, last: false },
    { lat: -15.82323, long: -47.927, last: false },
    { lat: -15.82323, long: -47.92701, last: false },
    { lat: -15.82324, long: -47.92701, last: false },
    { lat: -15.82325, long: -47.92702, last: false },
    { lat: -15.82325, long: -47.92703, last: false },
    { lat: -15.82326, long: -47.92703, last: false },
    { lat: -15.82327, long: -47.92704, last: false },
    { lat: -15.82328, long: -47.92704, last: false },
    { lat: -15.82329, long: -47.92705, last: false },
    { lat: -15.8233, long: -47.92705, last: false },
    { lat: -15.82331, long: -47.92705, last: false },
    { lat: -15.82333, long: -47.92706, last: false },
    { lat: -15.82335, long: -47.92706, last: false },
    { lat: -15.82336, long: -47.92705, last: false },
    { lat: -15.82337, long: -47.92705, last: false },
    { lat: -15.82338, long: -47.92705, last: false },
    { lat: -15.82339, long: -47.92705, last: false },
    { lat: -15.8234, long: -47.92704, last: false },
    { lat: -15.82341, long: -47.92703, last: false },
    { lat: -15.82342, long: -47.92703, last: false },
    { lat: -15.82343, long: -47.92702, last: false },
    { lat: -15.82343, long: -47.92701, last: false },
    { lat: -15.82344, long: -47.927, last: false },
    { lat: -15.82345, long: -47.92699, last: false },
    { lat: -15.82345, long: -47.92698, last: false },
    { lat: -15.82346, long: -47.92697, last: false },
    { lat: -15.82346, long: -47.92696, last: false },
    { lat: -15.82346, long: -47.92695, last: false },
    { lat: -15.82346, long: -47.92694, last: false },
    { lat: -15.82347, long: -47.92694, last: false },
    { lat: -15.82347, long: -47.92693, last: false },
    { lat: -15.82375, long: -47.92669, last: false },
    { lat: -15.8238, long: -47.92665, last: false },
    { lat: -15.82386, long: -47.92661, last: false },
    { lat: -15.82418, long: -47.92636, last: false },
    { lat: -15.8243, long: -47.92627, last: false },
    { lat: -15.82436, long: -47.92623, last: false },
    { lat: -15.82441, long: -47.92619, last: false },
    { lat: -15.82452, long: -47.92611, last: false },
    { lat: -15.82465, long: -47.92601, last: false },
    { lat: -15.82478, long: -47.9259, last: false },
    { lat: -15.825, long: -47.9257, last: false },
    { lat: -15.82501, long: -47.92573, last: false },
    { lat: -15.82527, long: -47.92552, last: false },
    { lat: -15.82537, long: -47.92546, last: false },
    { lat: -15.82546, long: -47.92538, last: false },
    { lat: -15.82554, long: -47.92532, last: false },
    { lat: -15.82568, long: -47.92522, last: false },
    { lat: -15.8257, long: -47.9252, last: false },
    { lat: -15.82588, long: -47.92501, last: false },
    { lat: -15.82596, long: -47.92482, last: false },
    { lat: -15.8259, long: -47.92474, last: false },
    { lat: -15.82587, long: -47.9247, last: false },
    { lat: -15.82579, long: -47.92457, last: false },
    { lat: -15.82568, long: -47.92442, last: false },
    { lat: -15.8261, long: -47.92412, last: false },
    { lat: -15.82642, long: -47.92387, last: false },
    { lat: -15.82643, long: -47.92386, last: false },
    { lat: -15.82644, long: -47.92385, last: false },
    { lat: -15.82645, long: -47.92384, last: false },
    { lat: -15.82647, long: -47.92382, last: false },
    { lat: -15.82648, long: -47.9238, last: false },
    { lat: -15.82648, long: -47.92378, last: false },
    { lat: -15.82649, long: -47.92376, last: false },
    { lat: -15.82649, long: -47.92375, last: false },
    { lat: -15.8265, long: -47.92373, last: false },
    { lat: -15.8265, long: -47.92372, last: false },
    { lat: -15.8265, long: -47.9237, last: false },
    { lat: -15.8265, long: -47.92369, last: false },
    { lat: -15.82649, long: -47.92363, last: false },
    { lat: -15.8265, long: -47.92352, last: false },
    { lat: -15.8265, long: -47.92351, last: false },
    { lat: -15.8265, long: -47.92349, last: false },
    { lat: -15.82651, long: -47.92348, last: false },
    { lat: -15.82651, long: -47.92346, last: false },
    { lat: -15.82652, long: -47.92345, last: false },
    { lat: -15.82652, long: -47.92344, last: false },
    { lat: -15.82653, long: -47.92342, last: false },
    { lat: -15.82653, long: -47.92341, last: false },
    { lat: -15.82654, long: -47.9234, last: false },
    { lat: -15.82655, long: -47.92339, last: false },
    { lat: -15.82656, long: -47.92338, last: false },
    { lat: -15.82663, long: -47.92334, last: false },
    { lat: -15.8267, long: -47.92329, last: false },
    { lat: -15.82685, long: -47.92317, last: false },
    { lat: -15.827, long: -47.923, last: false },
    { lat: -15.82711, long: -47.92298, last: false },
    { lat: -15.82721, long: -47.92291, last: false },
    { lat: -15.82731, long: -47.92283, last: false },
    { lat: -15.82741, long: -47.92274, last: false },
    { lat: -15.8275, long: -47.92267, last: false },
    { lat: -15.82758, long: -47.9226, last: false },
    { lat: -15.82761, long: -47.92257, last: false },
    { lat: -15.82764, long: -47.92255, last: false },
    { lat: -15.82775, long: -47.92246, last: false },
    { lat: -15.82787, long: -47.92238, last: false },
    { lat: -15.8281, long: -47.92222, last: false },
    { lat: -15.8281, long: -47.92223, last: false },
    { lat: -15.82811, long: -47.92223, last: false },
    { lat: -15.82812, long: -47.92224, last: false },
    { lat: -15.82812, long: -47.92225, last: false },
    { lat: -15.82813, long: -47.92225, last: false },
    { lat: -15.82814, long: -47.92226, last: false },
    { lat: -15.82815, long: -47.92226, last: false },
    { lat: -15.82816, long: -47.92227, last: false },
    { lat: -15.82817, long: -47.92227, last: false },
    { lat: -15.82818, long: -47.92228, last: false },
    { lat: -15.82819, long: -47.92228, last: false },
    { lat: -15.8282, long: -47.92228, last: false },
    { lat: -15.82821, long: -47.92228, last: false },
    { lat: -15.82822, long: -47.92228, last: false },
    { lat: -15.82823, long: -47.92228, last: false },
    { lat: -15.82824, long: -47.92227, last: false },
    { lat: -15.82825, long: -47.92227, last: false },
    { lat: -15.82826, long: -47.92227, last: false },
    { lat: -15.82826, long: -47.92226, last: false },
    { lat: -15.82827, long: -47.92226, last: false },
    { lat: -15.82828, long: -47.92225, last: false },
    { lat: -15.82847, long: -47.92251, last: false },
    { lat: -15.82853, long: -47.9226, last: false },
    { lat: -15.82923, long: -47.92354, last: false },
    { lat: -15.82935, long: -47.92373, last: false },
    { lat: -15.82947, long: -47.92391, last: false },
    { lat: -15.82947, long: -47.92392, last: false },
    { lat: -15.82946, long: -47.92393, last: false },
    { lat: -15.82946, long: -47.92394, last: false },
    { lat: -15.82946, long: -47.92395, last: false },
    { lat: -15.82945, long: -47.92396, last: false },
    { lat: -15.82945, long: -47.92397, last: false },
    { lat: -15.82938, long: -47.924, last: false },
    { lat: -15.82931, long: -47.92406, last: false },
    { lat: -15.82925, long: -47.92412, last: false },
    { lat: -15.82921, long: -47.92417, last: false },
    { lat: -15.82917, long: -47.92423, last: false },
    { lat: -15.82905, long: -47.92434, last: false },
    { lat: -15.82897, long: -47.9244, last: false },
    { lat: -15.82888, long: -47.92443, last: false },
    { lat: -15.82879, long: -47.92445, last: false },
    { lat: -15.8286, long: -47.92446, last: false },
    { lat: -15.8286, long: -47.92445, last: false },
    { lat: -15.8286, long: -47.92444, last: false },
    { lat: -15.8286, long: -47.92443, last: false },
    { lat: -15.82859, long: -47.92443, last: false },
    { lat: -15.82859, long: -47.92442, last: false },
    { lat: -15.82859, long: -47.92441, last: false },
    { lat: -15.82858, long: -47.92441, last: false },
    { lat: -15.82858, long: -47.9244, last: false },
    { lat: -15.82857, long: -47.9244, last: false },
    { lat: -15.82856, long: -47.9244, last: false },
    { lat: -15.82856, long: -47.92439, last: false },
    { lat: -15.82855, long: -47.92439, last: false },
    { lat: -15.82854, long: -47.92439, last: false },
    { lat: -15.82853, long: -47.92439, last: false },
    { lat: -15.82853, long: -47.9244, last: false },
    { lat: -15.82852, long: -47.9244, last: false },
    { lat: -15.82851, long: -47.9244, last: false },
    { lat: -15.82841, long: -47.92424, last: false },
    { lat: -15.82826, long: -47.92405, last: false },
    { lat: -15.82821, long: -47.92406, last: false },
    { lat: -15.82815, long: -47.92407, last: false },
    { lat: -15.8281, long: -47.92407, last: false },
    { lat: -15.828, long: -47.924, last: false },
    { lat: -15.82797, long: -47.92409, last: false },
    { lat: -15.82794, long: -47.92409, last: false },
    { lat: -15.8279, long: -47.9241, last: false },
    { lat: -15.82787, long: -47.92411, last: false },
    { lat: -15.82786, long: -47.92412, last: false },
    { lat: -15.82784, long: -47.92412, last: false },
    { lat: -15.82782, long: -47.92414, last: false },
    { lat: -15.82781, long: -47.92415, last: false },
    { lat: -15.82779, long: -47.92416, last: false },
    { lat: -15.82777, long: -47.92418, last: false },
    { lat: -15.82775, long: -47.92419, last: false },
    { lat: -15.82773, long: -47.92422, last: false },
    { lat: -15.82771, long: -47.92423, last: false },
    { lat: -15.8277, long: -47.92425, last: false },
    { lat: -15.82767, long: -47.92429, last: false },
    { lat: -15.82766, long: -47.9243, last: false },
    { lat: -15.82765, long: -47.92432, last: false },
    { lat: -15.82764, long: -47.92434, last: false },
    { lat: -15.82762, long: -47.92436, last: false },
    { lat: -15.82761, long: -47.92438, last: false },
    { lat: -15.8276, long: -47.9244, last: false },
    { lat: -15.82759, long: -47.92442, last: false },
    { lat: -15.82758, long: -47.92445, last: false },
    { lat: -15.82757, long: -47.92447, last: false },
    { lat: -15.82757, long: -47.92449, last: false },
    { lat: -15.82756, long: -47.92452, last: false },
    { lat: -15.82756, long: -47.92455, last: false },
    { lat: -15.82755, long: -47.92457, last: false },
    { lat: -15.82755, long: -47.92461, last: false },
    { lat: -15.82754, long: -47.92466, last: false },
    { lat: -15.82753, long: -47.92471, last: false },
    { lat: -15.82749, long: -47.92478, last: false },
    { lat: -15.82747, long: -47.92481, last: false },
    { lat: -15.82747, long: -47.92483, last: false },
    { lat: -15.82746, long: -47.92485, last: false },
    { lat: -15.82746, long: -47.92486, last: false },
    { lat: -15.82746, long: -47.92489, last: false },
    { lat: -15.82745, long: -47.92491, last: false },
    { lat: -15.82745, long: -47.92494, last: false },
    { lat: -15.82745, long: -47.92495, last: false },
    { lat: -15.82745, long: -47.92498, last: false },
    { lat: -15.82745, long: -47.92501, last: false },
    { lat: -15.82745, long: -47.92504, last: false },
    { lat: -15.82746, long: -47.92505, last: false },
    { lat: -15.82746, long: -47.92507, last: false },
    { lat: -15.82746, long: -47.9251, last: false },
    { lat: -15.82747, long: -47.92512, last: false },
    { lat: -15.82747, long: -47.92514, last: false },
    { lat: -15.82748, long: -47.92516, last: false },
    { lat: -15.8275, long: -47.92519, last: false },
    { lat: -15.82751, long: -47.92521, last: false },
    { lat: -15.82752, long: -47.92523, last: false },
    { lat: -15.82758, long: -47.92532, last: true },
  ],
};

const kafka = new Kafka({
  brokers: [process.env.BROKERS],
  ssl: true,
  sasl: {
    mechanism: "plain",
    username: process.env.USERNAME,
    password: process.env.PASSWORD,
  },
  logLevel: logLevel.NOTHING,
});

const producer = kafka.producer();
const consumer = kafka.consumer({ groupId: "geo" });

async function getCoordinates(value, producer) {
  const coordVals = coordinates[value];

  coordVals.forEach((coord, i) => {
    setTimeout(async () => {
      console.log("the coordinate: ", { ...coord, id: value });
      await producer.send({
        topic: "coordinates",
        messages: [{ value: JSON.stringify({ ...coord, id: value }) }],
      });
    }, i * process.env.COORDINATES_DELAY);
  });

  // await producer.disconnect();
}

const run = async () => {
  await producer.connect();
  await consumer.connect();
  await consumer.subscribe({ topic: "path", fromBeginning: false });

  await consumer.run({
    eachMessage: async ({ topic, partition, message }) => {
      console.log("received: ", message?.value?.toString());
      getCoordinates(message?.value?.toString(), producer);
    },
  });
};

run().catch(console.error);
